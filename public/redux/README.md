# Redux Implementation and Overview

## Contents
1. [Introduction] (https://github.com/daily-bruin/flatpage_generator#introduction)
2. [Actions] (https://github.com/daily-bruin/flatpage_generator#actions)
3. [Reducers] (https://github.com/daily-bruin/flatpage_generator#reducers)
4. [Store] (https://github.com/daily-bruin/flatpage_generator/store)
5. [Creating a New Component] (https://github.com/daily-bruin/flatpage_generator#creating-a-new-component)

### Introduction
Redux is used to dynamically create new web components for a new page and store them for easy access in the application.
Redux has a flow of information that is as follows:

Call on the store to dispatch an action

 ```javascript 
 store.dispatch(action)
 ```
The store calls a reducer function which computes the next state of the store.

The root reducer combines the outputs of multiple reducers into a single state tree.

The new entire single state tree is returned altering what is displayed on the application

react component -> action -> reducer -> store




### Actions
Our main actions in the flatpage_generator give information necessary to create a new webpage component
To add actions, modify `public/redux/actions.js`

Here is an example to create a Header component within our application

```javascript
export const addHeader = (title, author, coverImageUrl, key,button,comp_type) => {
    return {
        type: 'ADD_HEADER',
        title: title,
        author: author,
        url: coverImageUrl,
        key: key,
        button: button,
        comp_type: comp_type,
    }
}
```
* `type` is a string that is used to identify the action when passed to the reducer function
* `title`, `author`, and `url` are information that we need to fill our component with 
* `key` is the database id that is generated by the Dashboard component `public/components/Dashboard` that is tied with the new component
* `button` is an React button group that needs to include an edit button to edit the component when added to the page preview and a delete button
* `component`is a string that identifies what type of component you are creating. (eg for our example comp_type is "header")


### Reducers
Our reducers can befound in `public/redux/reducers.js`

Redux works with only one store. However you can have multiple reducers that contain differents pieces of data 
that will get combined together into one single state tree in our `public/redux/reducers/index.js`

Here is an simplified example of our `_dashboard` reducer function that returns a newly generated state of _dashboard

```javascript
export function  _dashboard(state = [], action) {
    switch (action.type) {
        case 'ADD_HEADER':
            const header = <Header  title={action.title}
                                    author={action.author}
                                    image={action.url}/>;
            return [
              ...state,
              header
            ]
        default:
            return state;
    }
}

```

In this example we have a part of store called _dashboard which we can access by 
```javascript
store.getState()._dashboard
```

* Notice how in our reducer function we pass in a state and an action
* We must check on the type of the action via `action.type` in order to determine how to generate the next state
* Regardless of action being taken we must return either a state object `{}` or state array `[]` (array in our application)
* In our example we have create a new Header component using the information from the action that was passed in and add it to the state array


### Store

After a component dispatches an action to a reducer in redux, the reducer returns a new state. 
Smaller reducers can be combined into one large state tree. 
You can see this in `public/redux/reducers/index.js`

In our application we have two smaller reducers:
* _dashboard which stores the number of components a user has created for a new page
* _header which stores the metadata of the generated webpage

```javascript
export function _dashboard(state=[], action) {
  ...
}

export function _header(state=[], action) {
  ...
}
```

We combine these into a single store 
```javascript
export default function () {
    var reducer = combineReducers(reducers)
    var store = createStore(reducer);
    return store;
}
```

However, when we want to access the information in a particular store (which is part of the larger store), we make the following call
```javascript
store.getState()._dashboard
store.getState()._header
```
### Creating a New Component
